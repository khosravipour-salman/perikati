{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>رادا | داشبورد</title>
    <link href='{% static "app_base/css/bootstrap.min.css" %}' rel="stylesheet">
    <link href='{% static "app_base/css/bootstrap.rtl.min.css" %}' rel="stylesheet">
    <link href='{% static "app_base/font-awesome/css/font-awesome.css" %}' rel="stylesheet">
    <!-- Toastr style -->
    <!-- <link href='{% static "app_base/css/plugins/toastr/toastr.min.css" %}' rel="stylesheet"> -->
    <!-- Gritter -->
    <link href='{% static "app_base/js/plugins/gritter/jquery.gritter.css" %}' rel="stylesheet">
    <link href='{% static "app_base/css/animate.css" %}' rel="stylesheet">
    <link href='{% static "app_base/css/style.rtl.css" %}' rel="stylesheet">

    <link href='{% static "app_base/css/plugins/steps/jquery.steps.css" %}' rel="stylesheet">
    <link href='{% static "app_base/css/plugins/persian-datepicker/persian-datepicker.min.css" %}' rel="stylesheet">


</head>

<body>
    <div id="wrapper">
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav metismenu" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element"> <span>
                                <img alt="image" class="img-circle" src={% static "app_base/img/profile_small_3.png" %} />
                            </span>
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="clear" style="margin-right: 15px;"> 
                                    <span class="block m-t-xs"> <strong class="font-bold">{{ request.user }}</strong></span>
                                </span> 
                            </a>
                        </div>
                        <div class="logo-element" style="font-size: 15px; padding: 10px;">
                            پریکاتی
                        </div>
                    </li>
                    <li>
                        <a href="{% url 'admin:app_list' app_label='auth' %}"><i class="fa fa-th-large"></i> <span class="nav-label">مدیریت کاربران</span></a>
                    </li>
                    <li>
                        <a href="{% url 'admin:app_list' app_label='app_base' %}"><i class="fa fa-th-large"></i> <span class="nav-label">پیش فاکتور ها</span></a>
                    </li>
                    <li>
                        <a href="/"><i class="fa fa-th-large"></i> <span class="nav-label">ثبت پیش فاکتور</span></a>
                    </li>
                </ul>
            </div>
        </nav>
        <div id="page-wrapper" class="gray-bg dashbard-1">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-primary" href="#"><i
                                class="fa fa-bars"></i> </a>
                    </div>
                    <ul class="nav navbar-top-links navbar-left" style="display: flex">
                        <li>
                            <a href="{% url 'admin:logout' %}">خروج</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="row border-bottom ">
                <div class="col-sm-12" style="min-height: 70vh">
                    <div class="ibox">
                        <div class="ibox-title">
                            <h5>عملیات</h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    <i class="fa fa-wrench"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-user">
                                    <li><a href="#">گزینه 1</a>
                                    </li>
                                    <li><a href="#">گزینه 2</a>
                                    </li>
                                </ul>
                                <a class="close-link">
                                    <i class="fa fa-times"></i>
                                </a>
                            </div>
                        </div>
                        <div class="ibox-content">
             
                            <form id="form" action="" class="wizard-big" method="POST" onsubmit="return checkforblank()">
                                {% csrf_token %}
                                <h1>تسهیم مبلغ خرید</h1>
                                <fieldset>
                                    <h3 style="font-weight: normal">
                                        مبلغ پرداختی خود را به ازای هر خانواده محصول
                                        <strong>به ریال</strong> مشخص کنید.
                                    </h3>
                                    <div class="row">
                                        {% for p in products %}
                                        <div class="col-lg-4">
                                            <div class="panel panel-default">
                                                <div class="panel-heading">{{ p.1 }}</div>
                                                <div class="panel-body">
                                                    <div class="form-group">
                                                        <label>تعداد</label>
                                                        <input id="product-count-{{ p.0 }}" name="product-count-{{ p.0 }}" type="number"
                                                            class="form-control" min="0">
                                                    </div>
                                                    <div class="form-group">
                                                        <label>مبلغ واحد</label>
                                                        <input id="product-price-{{ p.0 }}" name="product-price-{{ p.0 }}" type="number"
                                                            class="form-control" min="0">
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </fieldset>

                                <h1>اطلاعات خریدار</h1>
                                <fieldset>
                                    <div class="row">
                                        <div class="col-lg-8">
                                            <table style="width: 100%;">
                                                <tr>
                                                    <td style="padding-left: 10px; width: 48%;">
                                                        <div class="form-group">

                                                            <label>نام *</label>
                                                            {% render_field form.customer_name class='form-control' value='سلمان' %}
                                                            {% comment %} <input name="name" type="text" class="form-control required" value="سلمان"> {% endcomment %}
                                                        </div>
                                                    </td>
                                                    <td style="width: 48%;">
                                                        <div class="form-group">
                                                            <label>نام خانوادگی *</label>
                                                            {% render_field form.customer_last_name  class='form-control required' value='خسروی' %}
                                                            {% comment %} <input name="last-name" type="text" class="form-control required" value="خسروی "> {% endcomment %}
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <div class="form-group">
                                                <label>کد ملی *</label>
                                                {% render_field form.customer_national_code class='form-control required' value='0024367011' %}
                                                {% comment %} <input name="national-code" type="text" class="form-control required" value="0024367715"> {% endcomment %}
                                            </div>
                                            <div class="form-group">
                                                 <label for="id_customer_birthdate">تاریخ تولد *</label>
                                                <!-- <input name="birthdate" type="text" class="form-control"> -->
                                                <div class="input-group date">
                                                    <span class="input-group-addon">
                                                        <i class="fa fa-calendar">
                                                        </i>
                                                    </span>
                                                    {% render_field form.customer_birthdate class='form-control required' value='1370/05/08' %}
                                                    {% comment %} <input id="date_added" type="text" name="birthdate" class="form-control required" value="1380/05/08"> {% endcomment %}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>تلفن همراه *</label>
                                                {% render_field form.customer_phone_number class='form-control required' value='09309815604' %}
                                                {% comment %} <input name="phone-number" type="text" class="form-control required" value="09013255112"> {% endcomment %}
                                            </div>
                                            <div class="form-group">
                                                <label>کد پستی</label>
                                                {% render_field form.customer_postal_code class='form-control' value='1744935353' %}
                                                {% comment %} <input name="postal-code" type="text" class="form-control" value="4825985353"> {% endcomment %}
                                            </div>
                                            <table style="width: 100%;">
                                                <tr>
                                                    <td style="padding-left: 10px; width: 48%;">
                                                        <div class="form-group">
                                                            <label>شهر *</label>
                                                            <!-- <input name="city" type="text" class="form-control"> -->
                                                            <select class="form-control required" id="city" name="city">
                                                                {% for city in city_list %}
                                                                <option value="{{ city }}">{{ city }}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>                                                        
                                                    </td>
                                                    <td style="width: 48%;">
                                                        <div class="form-group">
                                                            <label>استان *</label>
                                                            <!-- <input name="state" type="text" class="form-control"> -->
                                                            <select class="form-control required" id="state" name="state">
                                                                <option>استان را انتخاب کنید</option>
                                                            </select>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            <div class="form-group">
                                                <label>نحوه تسویه حق العمل *</label>
                                                <!-- <input name="purchase method" type="text" class="form-control"> -->
                                                {% comment %} {% render_field form.purchase_method class='form-control required' %} {% endcomment %}
                                                <select class="form-control required" name="purchase-method">
                                                    <option>انتخاب نحوه تسویه وجه ...</option>
                                                    <option>نقدی</option>
                                                    <option>کارت اعتباری</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>آدرس *</label>
                                                {% render_field form.customer_address class='form-control required' value='تهران تهران نو خیابان بلال حبشی پلاک چهل و پنج' %}
                                                {% comment %} <input name="address" type="text" class="form-control required" value="تهران  تهران نو "> {% endcomment %}
                                            </div>
                                            <div class="form-group">
                                                <label>توضیحات</label>
                                                {% render_field form.description class='form-control required' value='این یک تستی بیش نیست' %}
                                                {% comment %} <input name="description" type="text" class="form-control" value="این یک تستی بیش نیست"> {% endcomment %}
                                            </div>

                                            {% if form.errors %}
                                            <div class="form-group">
                                                <label style="color: red;">خطا</label>
                                                {% for field in form %}
                                                    {% for error in field.errors %}
                                                    {% comment %} <p style="font-weight: normal"> {% endcomment %}
                                                        {{field.label}}: {{ error|escape }} ---
                                                    {% comment %} </p> {% endcomment %}
                                                    {% endfor %}
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="text-center">
                                                <div style="margin-top: 20px">
                                                    <i class="fa fa-sign-in"
                                                        style="font-size: 180px;color: #e5e5e5 "></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </fieldset>
                                
                                <h1>پیش نمایش پرداخت</h1>
                                <fieldset>
                                    <div  id="printableArea">
                                    <fieldset disabled="disabled">
                                    <h2>پیش نمایش پرداخت</h2>
                                    <table style="width: 100%;">
                                        <tr>
                                            <td style="padding-left: 10px;">
                                                <div class="form-group">
                                                    <label>نام *</label>
                                                    {% render_field form.customer_name class='form-control required' %}
                                                    <!-- <input name="name" type="text" class="form-control required" value="{{ subbmited_data }}" disabled="" style="cursor: context-menu;"> -->
                                                </div>                                                        
                                            </td>
                                            <td style="padding-left: 10px;">
                                                <div class="form-group">
                                                    <label>نام خانوادگی *</label>
                                                    {% render_field form.customer_last_name class='form-control required' %}
                                                    <!-- <input name="last-name" type="text" class="form-control required" value="خسروی " disabled="" style="cursor: context-menu;"> -->
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label>تاریخ تولد *</label>
                                                    {% render_field form.customer_birthdate class='form-control required' %}
                                                    <!-- <input type="text" name="birthdate" class="form-control required" value="1380/05/08" disabled="" style="cursor: context-menu;"> -->
                                               </div>                                                     
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-left: 10px;">
                                                <div class="form-group">
                                                    <label>تلفن همراه *</label>
                                                    {% render_field form.customer_phone_number class='form-control required' %}
                                                     <!-- <input name="phone-number" type="text" class="form-control required" value="09013255112" disabled="" style="cursor: context-menu;">  -->
                                                </div>
                                            </td>
                                            <td style="padding-left: 10px;">
                                                <div class="form-group">
                                                    <label>کد ملی *</label>
                                                    {% render_field form.customer_national_code class='form-control required' %}
                                                    <!-- <input name="national-code" type="text" class="form-control required" value="0024367715" disabled="" style="cursor: context-menu;"> -->
                                                </div>                                                   
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label>کد پستی</label>
                                                    {% render_field form.customer_postal_code class='form-control required' %}
                                                     <!-- <input name="postal-code" type="text" class="form-control" value="4825985353" disabled="" style="cursor: context-menu;">  -->
                                                </div>
                                            </td>
                                        </tr>

                                    </table>
                                   <table style="width: 100%;">
                                       <tr>
                                           <td style="padding-left: 10px;">
                                               <div class="form-group">
                                                   <label>شهر *</label>
                                                   {% render_field form.customer_city class='form-control required' %}
                                                   <!-- <select class="form-control required" id="city" name="city" disabled="" style="border: 1px solid #ccc; cursor: context-menu;">
                                                       {% for city in city_list %}
                                                       <option value="{{ city }}">{{ city }}</option>
                                                       {% endfor %}
                                                   </select> -->
                                               </div>                                                        
                                           </td>
                                           <td style="padding-left: 10px;">
                                               <div class="form-group">
                                                   <label>استان *</label>
                                                   {% render_field form.customer_state class='form-control required' %}
                                                   <!-- <select class="form-control required" id="state" name="state" disabled="" style="border: 1px solid #ccc; cursor: context-menu;">
                                                       <option>استان را انتخاب کنید</option>
                                                   </select> -->
                                               </div>
                                           </td>
                                           <td>
                                            <div class="form-group">
                                                <label>نحوه تسویه حق العمل *</label>
                                                {% render_field form.purchase_method class='form-control required' %}
                                                <!-- <select class="form-control required" name="purchase-method" disabled="" style="border: 1px solid #ccc; cursor: context-menu;">
                                                    <option>انتخاب نحوه تسویه وجه ...</option>
                                                    <option>نقدی</option>
                                                    <option>کارت اعتباری</option>
                                                </select> -->
                                            </div>
                                           </td>
                                       </tr>
                                   </table>
                                   <div class="form-group">
                                       <label>آدرس *</label>
                                       {% render_field form.customer_address class='form-control required' %}
                                        <!-- <input name="address" type="text" class="form-control required" value="تهران  تهران نو " disabled="" style="cursor: context-menu;">  -->
                                   </div>
                                   <div class="form-group">
                                       <label>توضیحات</label>
                                       {% render_field form.description class='form-control required' %}
                                        <!-- <input name="description" type="text" class="form-control" value="این یک تستی بیش نیست" disabled="" style="cursor: context-menu;">  -->
                                   </div>

                                    <br/><br/><br/>
                                    <table class="table" style="border: 1px solid #ccc;">
                                        <thead style="border: 1px solid #ccc;">
                                        <tr>
                                            <th>#</th>
                                            <th>نام محصول</th>
                                            <th>تعداد</th>
                                            <th>مبلغ</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% with fixed_product as products %}
                                        {% for key, value in products.items %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>{{ key }} change this later</td>
                                            <td>{{ value.count }}</td>
                                            <td>{{ value.price }}</td>
                                        </tr>
                                        {% endfor %}
                                        {% endwith %}
                                        </tbody>
                                        <thead style="border: 3px dotted #ccc;">
                                            <tr>
                                                <th></th>
                                                <th> </th>
                                                <th>جمع کل:</th>
                                                <th>{{ price_total }}</th>
                                            </tr>
                                            </thead>
                                    </table>
                                </fieldset>
                            </div>
                                <table class="table" style="border: none;">
                                    <th style="text-align: end;">
                                        <form>
                                            <button type="button" class="btn btn-w-m btn-primary" style="width: 20%;" onclick="printDiv('printableArea')">صدور پیش فاکتور (جهت ارائه به بانک)</button>
                                        </form>
                                    </th>
                                </table>
                        </fieldset>
                    </form>
                                    <!-- $("p").html() -->
                                    <!-- <h2>اطلاعات پروفایل</h2>
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="form-group">
                                                <label>نام *</label>
                                                <input id="name" name="name" type="text" class="form-control">
                                            </div>
                                            <div class="form-group">
                                                <label>نام خانوادگی *</label>
                                                <input id="surname" name="surname" type="text"
                                                    class="form-control">
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="form-group">
                                                <label>ایمیل *</label>
                                                <input id="email" name="email" type="text"
                                                    class="form-control email">
                                            </div>
                                            <div class="form-group">
                                                <label>آدرس *</label>
                                                <input id="address" name="address" type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div> -->
                                
                                <!-- <h1>هشدار</h1>
                                <fieldset>
                                    <div class="text-center" style="margin-top: 120px">
                                        <h2>لورم ایپسوم </h2>
                                    </div>
                                </fieldset>
    
                                <h1>پایان</h1>
                                <fieldset>
                                    <h2>لورم ایپسوم</h2>
                                    <input id="acceptTerms" name="acceptTerms" type="checkbox" class="required"> <label
                                        for="acceptTerms">لورم ایپسوم متن ساختگی با تولید سادگی نامفهوم از صنعت چاپ و با
                                        استفاده از طراحان گرافیک است. </label>
                                </fieldset> -->
                            <!-- </form> -->
                        </div>
                        <div class="footer">
                            <div>
                                <strong>
                                    کلیه حقوق این سایت متعلق به هلدینگ توسعه و سرمایه گذاری <span style="color: black;">پریکاتی</span> میباشد
                                </strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mainly scripts -->
    <script src='{% static "app_base/js/jquery-2.1.1.js" %}'></script>
    <script src='{% static "app_base/js/bootstrap.min.js" %}'></script>
    <script src='{% static "app_base/js/plugins/metisMenu/jquery.metisMenu.js" %}'></script>
    <script src='{% static "app_base/js/plugins/slimscroll/jquery.slimscroll.min.js" %}'></script>

    <!-- Flot -->
    <script src='{% static "app_base/js/plugins/flot/jquery.flot.js" %}'></script>
    <script src='{% static "app_base/js/plugins/flot/jquery.flot.tooltip.min.js" %}'></script>
    <script src='{% static "app_base/js/plugins/flot/jquery.flot.spline.js" %}'></script>
    <script src='{% static "app_base/js/plugins/flot/jquery.flot.resize.js" %}'></script>
    <script src='{% static "app_base/js/plugins/flot/jquery.flot.pie.js" %}'></script>

    <!-- Peity -->
    <script src='{% static "app_base/js/plugins/peity/jquery.peity.min.js" %}'></script>
    <script src='{% static "app_base/js/demo/peity-demo.js" %}'></script>

    <!-- Custom and plugin javascript -->
    <script src='{% static "app_base/js/rada.js" %}'></script>
    <script src='{% static "app_base/js/plugins/pace/pace.min.js" %}'></script>

    <!-- jQuery UI -->
    <script src='{% static "app_base/js/plugins/jquery-ui/jquery-ui.min.js" %}'></script>

    <!-- GITTER -->
    <script src='{% static "app_base/js/plugins/gritter/jquery.gritter.min.js" %}'></script>

    <!-- Sparkline -->
    <script src='{% static "app_base/js/plugins/sparkline/jquery.sparkline.min.js" %}'></script>

    <!-- Sparkline demo data  -->
    <script src='{% static "app_base/js/demo/sparkline-demo.js" %}'></script>

    <!-- ChartJS-->
    <script src='{% static "app_base/js/plugins/chartJs/Chart.min.js" %}'></script>

    <!-- Toastr -->
    <!-- <script src='{% static "app_base/js/plugins/toastr/toastr.min.js" %}'></script> -->

    <!-- Steps -->
    <!-- <script src='{% static "app_base/js/plugins/staps/jquery.steps.min.js" %}'></script> -->
    <script src='{% static "app_base/js/jquery.steps.min.js" %}'></script>
    <!-- plugins/staps/jquery.steps.min.js -->
    <!-- Jquery Validate -->
    <script src='{% static "app_base/js/plugins/validate/jquery.validate.min.js" %}'></script>
        
    <!-- Data picker -->
    <script src='{% static "app_base/js/plugins/persian-datepicker/persian-date.js" %}'/></script>
    <script src='{% static "app_base/js/plugins/persian-datepicker/persian-datepicker.min.js" %}'></script>
    
    <script>
        function printDiv(divName) {
            var printContents = document.getElementById(divName).innerHTML;
            var originalContents = document.body.innerHTML;

            document.body.innerHTML = printContents;

            window.print();

            document.body.innerHTML = originalContents;
        }
        $(document).ready(function () {

            // setTimeout(function () {
            //     toastr.options = {
            //         closeButton: true,
            //         progressBar: true,
            //         showMethod: 'slideDown',
            //         positionClass: 'toast-top-left',
            //         timeOut: 4000
            //     };
            //     toastr.success('لورم ایپسوم متن ساختگی با تولید سادگی نامفهوم از صنعت چاپ', 'به قسمت مدیریت خوش آمدید');

            // }, 1300);

            var data1 = [
                [0, 4], [1, 8], [2, 5], [3, 10], [4, 4], [5, 16], [6, 5], [7, 11], [8, 6], [9, 11], [10, 30], [11, 10], [12, 13], [13, 4], [14, 3], [15, 3], [16, 6]
            ];
            var data2 = [
                [0, 1], [1, 0], [2, 2], [3, 0], [4, 1], [5, 3], [6, 1], [7, 5], [8, 2], [9, 3], [10, 2], [11, 1], [12, 0], [13, 2], [14, 8], [15, 0], [16, 0]
            ];
            $("#flot-dashboard-chart").length && $.plot($("#flot-dashboard-chart"), [
                data1, data2
            ],
                {
                    series: {
                        lines: {
                            show: false,
                            fill: true
                        },
                        splines: {
                            show: true,
                            tension: 0.4,
                            lineWidth: 1,
                            fill: 0.4
                        },
                        points: {
                            radius: 0,
                            show: true
                        },
                        shadowSize: 2
                    },
                    grid: {
                        hoverable: true,
                        clickable: true,
                        tickColor: "#d5d5d5",
                        borderWidth: 1,
                        color: '#d5d5d5'
                    },
                    colors: ["#1ab394", "#464f88"],
                    xaxis: {
                    },
                    yaxis: {
                        ticks: 4
                    },
                    tooltip: false
                }
            );

            var doughnutData = [
                {
                    value: 300,
                    color: "#a3e1d4",
                    highlight: "#1ab394",
                    label: "App"
                },
                {
                    value: 50,
                    color: "#dedede",
                    highlight: "#1ab394",
                    label: "Software"
                },
                {
                    value: 100,
                    color: "#b5b8cf",
                    highlight: "#1ab394",
                    label: "Laptop"
                }
            ];

            var doughnutOptions = {
                segmentShowStroke: true,
                segmentStrokeColor: "#fff",
                segmentStrokeWidth: 2,
                percentageInnerCutout: 45, // This is 0 for Pie charts
                animationSteps: 100,
                animationEasing: "easeOutBounce",
                animateRotate: true,
                animateScale: false
            };

            // var ctx = document.getElementById("doughnutChart").getContext("2d");
            // var DoughnutChart = new Chart(ctx).Doughnut(doughnutData, doughnutOptions);

            var polarData = [
                {
                    value: 300,
                    color: "#a3e1d4",
                    highlight: "#1ab394",
                    label: "App"
                },
                {
                    value: 140,
                    color: "#dedede",
                    highlight: "#1ab394",
                    label: "Software"
                },
                {
                    value: 200,
                    color: "#b5b8cf",
                    highlight: "#1ab394",
                    label: "Laptop"
                }
            ];

            var polarOptions = {
                scaleShowLabelBackdrop: true,
                scaleBackdropColor: "rgba(255,255,255,0.75)",
                scaleBeginAtZero: true,
                scaleBackdropPaddingY: 1,
                scaleBackdropPaddingX: 1,
                scaleShowLine: true,
                segmentShowStroke: true,
                segmentStrokeColor: "#fff",
                segmentStrokeWidth: 2,
                animationSteps: 100,
                animationEasing: "easeOutBounce",
                animateRotate: true,
                animateScale: false
            };
            // var ctx = document.getElementById("polarChart").getContext("2d");
            // var Polarchart = new Chart(ctx).PolarArea(polarData, polarOptions);
            // https://github.com/rstaib/jquery-steps/wiki/Settings
            // startindex
            $("#form").steps({
                bodyTag: "fieldset",
                startIndex: {{ flag }},
                enableFinishButton: false,
                onStepChanging: function (event, currentIndex, newIndex) {
                    // Always allow going backward even if the current step contains invalid fields!
                    if (currentIndex > newIndex) {
                        return true;
                    }

                    // Forbid suppressing "Warning" step if the user is to young
                    if (newIndex === 3 && Number($("#age").val()) < 18) {
                        return false;
                    }

                    var form = $(this);

                    // Clean up if user went backward before
                    if (currentIndex < newIndex) {
                        // To remove error styles
                        $(".body:eq(" + newIndex + ") label.error", form).remove();
                        $(".body:eq(" + newIndex + ") .error", form).removeClass("error");
                    }

                    // Disable validation on fields that are disabled or hidden.
                    form.validate().settings.ignore = ":disabled,:hidden";

                    // Start validation; Prevent going forward if false
                    return form.valid()
                    // if (form.valid()) {
                    //     $('#submit').click()
                    // } else {
                    // return false
                    // }

                },
                onStepChanged: function (event, currentIndex, priorIndex) {
                    // Suppress (skip) "Warning" step if the user is old enough.
                    if (currentIndex === 2 && Number($("#age").val()) >= 18) {
                        $(this).steps("next");
                    }

                    // Suppress (skip) "Warning" step if the user is old enough and wants to the previous step.
                    if (currentIndex === 2 && priorIndex === 3) {
                        $(this).steps("previous");
                    }

                    if (currentIndex === 2) {
                        form.submit();
                    }

                    if(currentIndex === 3)
                    {
                    $("#form .actions a[href='#finish']").hide();
                    }
                },
                onFinishing: function (event, currentIndex) {
                    var form = $(this);

                    // Disable validation on fields that are disabled.
                    // At this point it's recommended to do an overall check (mean ignoring only disabled fields)
                    form.validate().settings.ignore = ":disabled";

                    // Start validation; Prevent form submission if false
                    return form.valid();
                },
                onFinished: function (event, currentIndex) {
                    var form = $(this);

                    // Submit form input
                    form.submit();
                }
            }).validate({
                errorPlacement: function (error, element) {
                    element.before(error);
                },
                rules: {
                    confirm: {
                        equalTo: "#password"
                    }
                }
            });

            $('#id_customer_birthdate').persianDatepicker({
                observer: true,
                format: 'YYYY/MM/DD'
            }).pDatepicker('setDate', [1394, 5, 1, 10, 0]);
            $('#date_modified').persianDatepicker({
                observer: true,
                format: 'YYYY/MM/DD'
            }).pDatepicker('setDate', [1394, 5, 2, 10, 0]);

            var cityList = {{ city_list| safe }};

            $("#city").change(function (event) {
            var selectedCity = $(this).find(":selected").val();
            var aa = cityList[selectedCity]
            var newOptions = ''
            $.each(aa, function (index, val) {
                console.log(index, val)
                newOptions += `<option value="${val}">${val}</option>`
            });
            $('#state').html(newOptions)
        });

        });
    </script>
</body>

</html>